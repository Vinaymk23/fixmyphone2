<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Repair Mobile Phone - fixmyPhone</title>
    <meta
      name="description"
      content="Choose your smartphone brand to start your repair request with fixmyPhone. We repair all major phone brands in Mysore."
    />

    <!-- Tailwind CSS, Font Awesome, and Google Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .brand-card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
      }
      .brand-card:hover {
        transform: translateY(-4px) scale(1.02);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      .quote-modal {
        transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
      }
      .modal-content-transition {
        transition: transform 0.3s ease-in-out;
      }
    </style>
  </head>

  <body class="bg-gray-50 text-gray-800">
    <!-- Header -->
    <header class="sticky top-0 left-0 w-full z-40 bg-white shadow-md py-4">
      <nav class="container mx-auto px-6 flex justify-between items-center">
        <a href="index.html" class="flex items-center space-x-2">
          <span class="text-2xl font-bold text-blue-600">fixmyPhone</span>
        </a>
        <a
          href="contact.html"
          class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-full shadow-md hover:bg-blue-700 transition-colors duration-200"
          >Contact Us</a
        >
      </nav>
    </header>

    <main class="pt-12 pb-20">
      <div class="container mx-auto px-6">
        <!-- Breadcrumb Navigation -->
        <nav class="text-sm text-gray-500 mb-8">
          <ol class="list-none p-0 inline-flex">
            <li class="flex items-center">
              <a href="index.html" class="text-blue-600 hover:text-blue-800"
                >Home</a
              >
              <i class="fas fa-chevron-right mx-2 text-xs"></i>
            </li>
            <li class="flex items-center">
              <span class="text-gray-900 font-semibold"
                >Repair Mobile Phone</span
              >
            </li>
          </ol>
        </nav>

        <h1 class="text-3xl lg:text-4xl font-extrabold text-center mb-4">
          Select Your Smartphone Brand
        </h1>
        <p class="text-center text-gray-600 mb-12 max-w-2xl mx-auto">
          Find your device and begin your repair journey. We offer expert
          services for a wide range of manufacturers.
        </p>

        <div
          id="brand-grid"
          class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6"
        >
          <!-- Brand Cards will be dynamically inserted here -->
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
      <div class="container mx-auto px-6 text-center">
        <p>&copy; 2024 fixmyPhone. All rights reserved.</p>
        <div class="mt-4">
          <a
            href="privacy.html"
            class="hover:underline text-sm text-gray-400 mx-2"
            >Privacy Policy</a
          >
          <a
            href="terms.html"
            class="hover:underline text-sm text-gray-400 mx-2"
            >Terms of Service</a
          >
        </div>
      </div>
    </footer>

    <!-- Direct Inquiry Modal for Unlisted Brands -->
    <div
      id="direct-inquiry-modal"
      class="quote-modal fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 opacity-0 invisible"
    >
      <div
        class="modal-content-transition bg-white p-8 rounded-xl shadow-lg w-full max-w-lg mx-4 transform scale-95"
      >
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-2xl font-bold text-gray-800">Direct Inquiry</h3>
          <button
            id="close-inquiry-modal"
            class="text-gray-500 hover:text-gray-800 text-2xl"
          >
            &times;
          </button>
        </div>
        <p class="text-gray-600 mb-6">
          Please tell us about your device and the issue you're facing. We'll
          get back to you with a custom quote.
        </p>
        <form id="direct-inquiry-form" novalidate>
          <div class="mb-4">
            <label
              for="inquiry-device"
              class="block text-gray-700 font-semibold mb-2"
              >Phone Brand & Model</label
            >
            <input
              type="text"
              id="inquiry-device"
              name="inquiry-device"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="e.g., Nothing Phone (2)"
              required
            />
          </div>
          <div class="mb-6">
            <label
              for="inquiry-issue"
              class="block text-gray-700 font-semibold mb-2"
              >Describe the Issue</label
            >
            <textarea
              id="inquiry-issue"
              name="inquiry-issue"
              rows="3"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="e.g., The screen is flickering and the battery drains very quickly."
              required
            ></textarea>
          </div>
          <div class="mb-4">
            <label
              for="inquiry-name"
              class="block text-gray-700 font-semibold mb-2"
              >Name</label
            >
            <input
              type="text"
              id="inquiry-name"
              name="inquiry-name"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="e.g., Rahul K."
              required
            />
          </div>
          <div class="mb-4">
            <label
              for="inquiry-phone"
              class="block text-gray-700 font-semibold mb-2"
              >Phone Number</label
            >
            <input
              type="tel"
              id="inquiry-phone"
              name="inquiry-phone"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="e.g., 9876543210"
              required
            />
          </div>
          <div class="mb-4">
            <label
              for="inquiry-email"
              class="block text-gray-700 font-semibold mb-2"
              >Email Address</label
            >
            <input
              type="email"
              id="inquiry-email"
              name="inquiry-email"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
              placeholder="e.g., rahul@example.com"
              required
            />
          </div>
          <button
            type="submit"
            id="submit-inquiry"
            class="w-full bg-blue-600 text-white font-semibold py-3 rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center justify-center"
          >
            <span id="inquiry-submit-text">Submit Inquiry</span>
            <i
              id="inquiry-submit-spinner"
              class="fas fa-spinner fa-spin ml-2 hidden"
            ></i>
          </button>
          <p
            id="inquiry-form-error"
            class="text-red-500 text-sm mt-2 text-center hidden"
          ></p>
        </form>
      </div>
    </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import {
        getFirestore,
        collection,
        addDoc,
        serverTimestamp,
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

      let firebaseConfig =
        typeof __firebase_config !== "undefined"
          ? JSON.parse(__firebase_config)
          : null;
      let appId = typeof __app_id !== "undefined" ? __app_id : null;
      let db = null;
      let isLocalTestMode = false;

      if (!firebaseConfig || !appId) {
        console.warn(
          "Firebase config not found. Activating local testing mode."
        );
        isLocalTestMode = true;
        firebaseConfig = {
          apiKey: "dummy",
          authDomain: "dummy.firebaseapp.com",
          projectId: "dummy",
        };
        appId = "local-test";
      }

      try {
        const app = initializeApp(firebaseConfig);
        db = getFirestore(app);
      } catch (e) {
        console.error("Firebase init failed", e);
        db = null;
      }

      document.addEventListener("DOMContentLoaded", () => {
        const brands = [
          {
            name: "Apple",
            logo: "https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg",
            url: "brands/apple.html",
          },
          {
            name: "Samsung",
            logo: "https://upload.wikimedia.org/wikipedia/commons/2/24/Samsung_Logo.svg",
            url: "brands/samsung.html",
          },
          {
            name: "Google",
            logo: "https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg",
            url: "brands/google.html",
          },
          {
            name: "OnePlus",
            logo: "https://www.svgrepo.com/show/522100/oneplus.svg",
            url: "brands/oneplus.html",
          },
          {
            name: "Xiaomi",
            logo: "https://www.svgrepo.com/show/521971/xiaomi-black.svg",
            url: "brands/xiaomi.html",
          },
          {
            name: "Oppo",
            logo: "https://www.svgrepo.com/show/354158/oppo.svg",
            url: "brands/oppo.html",
          },
          {
            name: "Vivo",
            logo: "https://www.svgrepo.com/show/354899/vivo.svg",
            url: "brands/vivo.html",
          },
          {
            name: "Realme",
            logo: "https://www.svgrepo.com/show/521857/realme.svg",
            url: "brands/realme.html",
          },
          {
            name: "Motorola",
            logo: "https://www.svgrepo.com/show/354054/motorola.svg",
            url: "brands/motorola.html",
          },
          {
            name: "Nothing",
            logo: "https://www.svgrepo.com/show/521743/nothing-logo.svg",
            url: "brands/nothing.html",
          },
        ];

        const brandGrid = document.getElementById("brand-grid");
        brands.forEach((brand) => {
          const card = document.createElement("a");
          card.href = brand.url;
          card.className =
            "brand-card flex flex-col items-center p-6 bg-white rounded-xl shadow-lg border-2 border-transparent hover:border-blue-500";
          card.innerHTML = `
                <img src="${brand.logo}" alt="${brand.name} Logo" class="w-24 h-16 object-contain mb-2" />
                <span class="font-semibold text-lg text-center">${brand.name}</span>
            `;
          brandGrid.appendChild(card);
        });

        const manualCard = document.createElement("div");
        manualCard.id = "manual-brand-card";
        manualCard.className =
          "brand-card cursor-pointer flex flex-col items-center justify-center p-6 bg-gray-100 rounded-xl shadow-sm border-2 border-dashed border-gray-400 hover:border-blue-500 hover:bg-gray-200";
        manualCard.innerHTML = `<i class="fas fa-question-circle text-4xl text-gray-500 mb-2"></i><span class="font-semibold text-lg text-center text-gray-700">Brand Not Listed?</span>`;
        brandGrid.appendChild(manualCard);

        const inquiryModal = document.getElementById("direct-inquiry-modal");
        const inquiryModalContent = inquiryModal.querySelector(
          ".modal-content-transition"
        );
        const closeInquiryModalBtn = document.getElementById(
          "close-inquiry-modal"
        );
        const inquiryForm = document.getElementById("direct-inquiry-form");
        const submitInquiryBtn = document.getElementById("submit-inquiry");
        const inquirySubmitText = document.getElementById(
          "inquiry-submit-text"
        );
        const inquirySubmitSpinner = document.getElementById(
          "inquiry-submit-spinner"
        );
        const inquiryFormError = document.getElementById("inquiry-form-error");

        const showInquiryModal = () => {
          inquiryModal.classList.remove("invisible", "opacity-0");
          inquiryModalContent.classList.remove("scale-95");
          document.body.style.overflow = "hidden";
        };

        const hideInquiryModal = () => {
          inquiryModal.classList.add("invisible", "opacity-0");
          inquiryModalContent.classList.add("scale-95");
          document.body.style.overflow = "";
        };

        manualCard.addEventListener("click", showInquiryModal);
        closeInquiryModalBtn.addEventListener("click", hideInquiryModal);
        inquiryModal.addEventListener("click", (e) => {
          if (e.target === inquiryModal) hideInquiryModal();
        });

        inquiryForm.addEventListener("submit", async (e) => {
          e.preventDefault();
          if (!inquiryForm.checkValidity()) {
            inquiryFormError.textContent =
              "Please fill out all required fields.";
            inquiryFormError.classList.remove("hidden");
            return;
          }
          if (
            !/^\d{10}$/.test(document.getElementById("inquiry-phone").value)
          ) {
            inquiryFormError.textContent =
              "Please enter a valid 10-digit Indian phone number.";
            inquiryFormError.classList.remove("hidden");
            return;
          }
          if (
            !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(
              document.getElementById("inquiry-email").value
            )
          ) {
            inquiryFormError.textContent =
              "Please enter a valid email address.";
            inquiryFormError.classList.remove("hidden");
            return;
          }

          inquiryFormError.classList.add("hidden");
          submitInquiryBtn.disabled = true;
          inquirySubmitText.textContent = "Submitting...";
          inquirySubmitSpinner.classList.remove("hidden");

          if (isLocalTestMode) {
            console.log(
              "LOCAL TEST MODE: Simulating direct inquiry submission."
            );
            setTimeout(() => {
              const fakeDocId = `test_inquiry_${new Date().getTime()}`;
              window.location.href = `quote-confirmation.html?id=${fakeDocId}&direct=true`;
            }, 1500);
            return;
          }

          if (!db) {
            inquiryFormError.textContent =
              "Database not configured. Cannot submit.";
            inquiryFormError.classList.remove("hidden");
            submitInquiryBtn.disabled = false;
            inquirySubmitText.textContent = "Submit Inquiry";
            inquirySubmitSpinner.classList.add("hidden");
            return;
          }

          const formData = {
            name: document.getElementById("inquiry-name").value,
            phone: document.getElementById("inquiry-phone").value,
            email: document.getElementById("inquiry-email").value,
            device: `Unlisted Brand: ${
              document.getElementById("inquiry-device").value
            }`,
            services: document.getElementById("inquiry-issue").value,
            submittedAt: serverTimestamp(),
            status: "New (Unlisted)",
          };

          try {
            const collectionRef = collection(
              db,
              "artifacts",
              appId,
              "public",
              "data",
              "quoteRequests"
            );
            const docRef = await addDoc(collectionRef, formData);
            window.location.href = `quote-confirmation.html?id=${docRef.id}&direct=true`;
          } catch (error) {
            console.error("Error adding inquiry document: ", error);
            inquiryFormError.textContent =
              "Could not submit inquiry. Please try again.";
            inquiryFormError.classList.remove("hidden");
            submitInquiryBtn.disabled = false;
            inquirySubmitText.textContent = "Submit Inquiry";
            inquirySubmitSpinner.classList.add("hidden");
          }
        });
      });
    </script>
  </body>
</html>
